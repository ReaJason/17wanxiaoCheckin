# ğŸ›´17wanxiaoCheckin-Actions



> åŸºäºGitHub-Actionsçš„å®Œç¾æ ¡å›­å¥åº·æ‰“å¡
>
> æ¯å¤©æ—©ä¸Šå…­ç‚¹è‡ªåŠ¨æ‰“å¡ï¼Œå¾®ä¿¡æ¨é€æ‰“å¡ä¿¡æ¯
>
> å›¾åºŠä½¿ç”¨ï¼šGitHub+jsdelivr   å›¾ç‰‡è¿‡å¤šå¯èƒ½åŠ è½½ç¼“æ…¢
>
> æ¬¢è¿forkä½¿ç”¨âœ¨ï¼Œä¸€èµ·äº¤æµå­¦ä¹ 
>
> æ„Ÿè°¢ä½ çš„ä½¿ç”¨ï¼Œè§‰å¾—å¯ä»¥çš„è¯ï¼Œå¯ä¸å¯ä»¥ç»™ä¸ªå…è´¹çš„starâœ¨
>



## ä½ å¯ä»¥åœ¨æ­¤é¡¹ç›®ä¸­å­¦åˆ°çš„ä¸œè¥¿

1ã€æ¨¡æ‹Ÿå™¨ä½¿ç”¨httpcanaryæŠ“åŒ…ï¼ˆå…¶å®è¿˜å¯ä»¥ä½¿ç”¨fiddleè¿›è¡ŒæŠ“åŒ…ï¼‰

2ã€httpcanaryçš„åˆæ­¥ä½¿ç”¨

3ã€GitHub Actionsè‡ªåŠ¨åŒ–éƒ¨ç½²Pythonè„šæœ¬

4ã€æ¸…ç©ºGitHubçš„commitè®°å½•(æ–°å»ºåˆ†æ”¯ï¼Œé‡å‘½ååˆ†æ”¯ï¼Œä¸æ›´æ”¹æ–‡ä»¶)

5ã€......

## å¤æ‚çš„é£Ÿç”¨æ–¹æ³•

### ä¸€ã€æ¨¡æ‹Ÿå™¨æŠ“åŒ…è·å–æ•°æ®ï¼ˆå¦‚æœä½ çš„æ‰‹æœºå·²ROOTå¯ä»¥ç›´æ¥ç”¨æ‰‹æœºå“¦ï¼‰

#### 1ã€æ¨¡æ‹Ÿå™¨é…ç½®åŠä½¿ç”¨

- å¤©ç¿¼ç½‘ç›˜ï¼ˆå«é›·ç¥æ¨¡æ‹Ÿå™¨ã€å®Œç¾æ ¡å›­ã€httpcanaryå®‰è£…åŒ…ï¼‰
- ç‚¹é“¾æ¥è¿›å»å…¨éƒ¨ä¸‹ä¸‹æ¥ï¼šhttps://cloud.189.cn/t/VRZryeb2aIBr
- è§£å‹é›·ç¥æ¨¡æ‹Ÿå™¨å‹ç¼©åŒ…å¹¶ç‚¹å‡»ç»¿åŒ–ï¼ˆå‡ºç°ä»€ä¹ˆå¼‚å¸¸çš„è¯æŠŠæ€æ¯’è½¯ä»¶å…³é—­ï¼‰
- ç»¿åŒ–å®Œæˆç‚¹å‡»æ¡Œé¢å›¾æ ‡å¯åŠ¨
- æ‹–åŠ¨apkæ–‡ä»¶åˆ°æ¨¡æ‹Ÿå™¨çª—å£å®Œæˆappçš„å®‰è£…

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/å®‰è£…é›·ç¥æ¨¡æ‹Ÿå™¨.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/é›·ç¥æ¨¡æ‹Ÿå™¨è®¾ç½®.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/å®‰è£…apkæ–‡ä»¶.png)

#### 2ã€httpcanaryçš„é…ç½®åŠä½¿ç”¨

- æ‰“å¼€åˆšåˆšå®‰è£…åœ¨æ¡Œé¢çš„Httpcanary
- å®‰è£…è¯ä¹¦å¹¶ç§»åŠ¨åˆ°æ ¹ç›®å½•
- è®¾ç½®ç›®æ ‡åº”ç”¨ä¸ºå®Œç¾æ ¡å›­APPï¼ˆå°±ä¸éœ€è¦å…¶ä½™æ“ä½œäº†ï¼Œä¸è¦ç‚¹å³ä¸‹è§’çš„å°é£æœºï¼‰

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/åˆæˆ1.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/åˆæˆ2.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/åˆæˆ3.png)

#### 3ã€å¼€å§‹æŠ“åŒ…

- æ‰“å¼€å®Œç¾æ ¡å›­appï¼ˆæ˜¾ç¤ºrootå¿½ç•¥å³å¯ï¼‰ï¼Œè¿›å…¥å¥åº·æ‰“å¡å¹¶è®¾ç½®ç›¸å…³ä¿¡æ¯ï¼ˆä¸æäº¤ï¼‰
- åˆ‡æ¢åˆ°httpcanaryï¼Œå¼€å¯æŠ“åŒ…ï¼ˆç‚¹å³ä¸‹è§’çš„å°é£æœºï¼‰
- åˆ‡æ¢å®Œç¾æ ¡å›­æäº¤ä¿¡æ¯ï¼Œæ‰“å¡æˆåŠŸ
- åˆ‡æ¢httpcanaryï¼Œåœæ­¢æŠ“åŒ…

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/åˆæˆ4.png)

#### 4ã€æŠ“åŒ…åˆ†æ

- ç¿»é˜…æ‰¾åˆ°sasså­—æ ·çš„é“¾æ¥ï¼Œç‚¹å‡»è¿›å»ï¼ˆå¦‚æœæœ‰å¤šä¸ª, è¯·ç‚¹é ä¸Šé¢çš„ï¼‰
- ç¬¬ä¸€ä¸ªæ¡†ä¸ºè¯·æ±‚è¿æ¥ï¼Œç¬¬äºŒä¸ªæ¡†ä¸ºæ­¤ç½‘ç»œè¯·æ±‚ä¸ºpostè¯·æ±‚
- ç‚¹å‡»è¯·æ±‚ä¸€æ ï¼Œå¹¶åœ¨åº•éƒ¨é€‰æ‹©textï¼Œå³å¯æŸ¥çœ‹è‡ªå·±æ‰€å¡«å†™çš„æ•°æ®ï¼ˆè®°ä¸‹æ¥ï¼Œæˆ–è€…å¤åˆ¶å‡ºå»ï¼‰
- ç‚¹å‡»å“åº”ä¸€æ ï¼Œå¹¶åœ¨åº•éƒ¨é€‰æ‹©textï¼Œå³å¯æŸ¥çœ‹å“åº”ç»“æœï¼ˆæˆåŠŸåˆ™ä¸ºæ‰“å¡æˆåŠŸï¼Œæ‰“å¡é¢‘ç¹åˆ™å¤±è´¥ï¼‰
- è‡³æ­¤æˆ‘ä»¬å°±è·å¾—äº†æˆ‘ä»¬ç»å¤§å¤šæ•°çš„æ•°æ®äº†ï¼ˆä¸‹é¢é¡¹ç›®ä½¿ç”¨çš„æ•°æ®å¡«å†™éœ€è¦ï¼‰

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/åˆæˆ5.png)



### äºŒã€Serveré…±æœåŠ¡çš„ç”³è¯·

#### 1ã€ç”³è¯·ä¸€ä¸ªGItHubè´¦å·

- Githubå®˜ç½‘ï¼šhttps://github.com/ ï¼ˆä½¿ç”¨é‚®ç®±æ³¨å†Œå¹¶éªŒè¯ï¼‰

#### 2ã€æ³¨å†ŒServeré…±æœåŠ¡ï¼Œå¹¶ç»‘å®šå¾®ä¿¡

- Serveré…±å®˜ç½‘ï¼šhttp://sc.ftqq.com/3.version 
- ä½¿ç”¨åˆšæ³¨å†Œçš„Githubè´¦å·ç™»å½•
- å¾®ä¿¡ç»‘å®šï¼Œæ‰«ç å…³æ³¨å³å¯ç»‘å®š
- æµ‹è¯•ä¸€ä¸‹æ˜¯å¦èƒ½æ¨é€æˆåŠŸï¼Œå¹¶å¤åˆ¶ä¸‹è‡ªå·±çš„SCKEYï¼ˆä¸‹é¢é¡¹ç›®ä½¿ç”¨çš„æ•°æ®å¡«å†™éœ€è¦ï¼‰
- è‡³æ­¤æˆ‘ä»¬å°±è·å¾—äº†æˆ‘ä»¬çš„æœ€åä¸€ä¸ªæ•°æ®ï¼Œæ¥ä¸‹æ¥å°±æ˜¯äº†è§£å¦‚ä½•ä½¿ç”¨æ­¤é¡¹ç›®æ–‡ä»¶äº†

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/Server1.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/Server2.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/Server3.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/Server4.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/Server5.png)

### ä¸‰ã€é¡¹ç›®forkä¸éƒ¨ç½²

#### 1ã€ç‚¹å‡»é“¾æ¥è¿›å…¥é¡¹ç›®æ–‡ä»¶å¹¶forkåˆ°è‡ªå·±çš„GitHubä¸Š

- æ­¤é¡¹ç›®åœ°å€ï¼šhttps://github.com/ReaJason/17wanxiaoCheckin-Actions

- ç‚¹å‡»å³ä¸Šè§’çš„forkå³å¯å°†é¡¹ç›®æ–‡ä»¶æ‹‰åˆ°è‡ªå·±çš„åº“ä¸­

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/fork.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/fork2.png)

#### 2ã€è®¾ç½®Secretsï¼Œè¾“å…¥é¡¹ç›®è¿è¡Œçš„æ•°æ®

- æ‰¾åˆ°è‡ªå·±forkçš„åº“ï¼Œç‚¹å‡»Settings->Secrets->New sceret

- å­—æ®µåä½¿ç”¨å¤§å†™ï¼Œä¸‹é¢çš„å€¼åˆ™å¡«å†™è‡ªå·±çš„å€¼(ä¸è¦å›è½¦,å¹²å‡€åˆ©è½çš„å¡«å†™å°±å¯)ï¼Œæ€»å…±12ä¸ªï¼Œç»†å¿ƒå¡«å†™è¿™å…³ä¹ä¹‹åçš„æˆåŠŸä¸å¦

- ```
  # è®¾ç½®å¦‚ä¸‹secretå­—æ®µ
  """
  USERNAME(ç™»å½•è´¦å·)
  PASSWORD(ç™»å½•å¯†ç )
  ADDRESS(è¯¦ç»†åœ°å€)                    ä¾‹ï¼šéå¸¸å¯Œè´µ
  ADDTEXT(çœ-å¸‚-å¿/åŒº)                 ä¾‹ï¼šæ±Ÿè¥¿çœ-å—æ˜Œå¸‚-é«˜æ–°åŒº
  CODE(é‚®ç¼–)                       ä¾‹ï¼š360192
  EMERGENCY(ç´§æ€¥è”ç³»äºº)                ä¾‹ï¼šç´§æ€¥äºº
  EMERGENCYPHONE(ç´§æ€¥è”ç³»äººç”µè¯)        ä¾‹ï¼š23667712771
  SCKEY(Serveré…±å¾®ä¿¡æ¨é€)
  """
  ```

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/secrets.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/secrets2.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/secrets3.png)

#### 3ã€å¼€å¯Actions

- æ‰¾åˆ°è‡ªå·±forkçš„åº“ï¼Œç‚¹å‡»Settings->Action->I understand...

- å›åˆ°é¡¹ç›®ä¸»é¡µï¼Œä¿®æ”¹README.mdè§¦å‘Actions

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/action1.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/actions2.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/actions3.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/actions4.png)

#### 4ã€æŸ¥çœ‹ç»“æœ

- é€šè¿‡Update README.md -- > build -- > HealthCheckin
- æ‰‹æœºå¾®ä¿¡æ¨é€æŸ¥çœ‹
- æˆåŠŸäº†ä¸€æ¬¡ä¹‹ååˆ™å¼€å¯äº†è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼ˆæ¯å¤©æ—©ä¸Šå…­ç‚¹è‡ªåŠ¨æ‰“å¡ï¼‰
- å¦‚æœå¤±è´¥ï¼Œåˆ™åœ¨è¿è¡ŒçŠ¶å†µçš„HealthCheckinä¸­æŸ¥çœ‹æŠ¥é”™æƒ…å†µï¼Œè§£å†³ä¸äº†å¯ä»¥æissue

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/actions5.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/sucess.png)

![](https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/sucess1.jpg)

### å››ã€Actionså…·ä½“æµç¨‹

> Tipsï¼šactionsé…ç½®æ–‡ä»¶åœ¨\.github\workflows\run.ymlä¸­
>

#### 1ã€å‚æ•°è®¾ç½®(secret)

```python
# è®¾ç½®å¦‚ä¸‹secretå­—æ®µ
"""
USERNAME(ç™»å½•è´¦å·)
PASSWORD(ç™»å½•å¯†ç )
ADDRESS(è¯¦ç»†åœ°å€)                    ä¾‹ï¼šéå¸¸å¯Œè´µ
ADDTEXT(çœ-å¸‚-å¿/åŒº)                 ä¾‹ï¼šæ±Ÿè¥¿çœ-å—æ˜Œå¸‚-é«˜æ–°åŒº
CODE(é‚®ç¼–)                       ä¾‹ï¼š360192
EMERGENCY(ç´§æ€¥è”ç³»äºº)                ä¾‹ï¼šç´§æ€¥äºº
EMERGENCYPHONE(ç´§æ€¥è”ç³»äººç”µè¯)        ä¾‹ï¼š23667712771
SCKEY(Serveré…±å¾®ä¿¡æ¨é€)
"""


# ç›¸å…³å‚æ•°è®¾ç½®å³å¯¹åº”ä¸‹é¢çš„æ•°æ®è¾“å…¥
"""
python3 17wanxiao.py <<EOF
${{secrets.USENAME}}
${{secrets.PASSWORD}}
${{secrets.ADDRESS}}
${{secrets.ADDTEXT}}
${{secrets.CODE}}
${{secrets.EMERGENCY}}
${{secrets.EMERGENCYPHONE}}
${{secrets.SCKEY}}
EOF
"""
```

#### 2ã€è®¡åˆ’æ—¶é—´å‚æ•°

```python
schedule:
   - cron: 0 22 * * * # è¡¨ç¤ºæ¯å¤©6ç‚¹è¿›è¡Œä»»åŠ¡
# cronåé¢çš„æ—¶é—´ä¸ºå›½é™…äº‹ä»¶
# äº”ä½æ•°(ç©ºæ ¼åˆ†éš”)åˆ†åˆ«ä¸ºåˆ†é’Ÿã€å°æ—¶ã€å¤©ã€æœˆã€ä¸€ä¸ªæ˜ŸæœŸçš„ç¬¬å‡ å¤©
# å›½é™…æ—¶ä¸åŒ—äº¬æ—¶çš„æŸ¥è¯¢ç½‘ç«™ï¼šhttp://www.timebie.com/cn/universalbeijing.php
```

#### 3ã€Install Python

```python
# ä¸ºè™šæ‹Ÿæœºå®‰è£…python3ç¯å¢ƒ
run: |
    sudo apt update && \
    sudo apt install python3
# ç”±äºä½¿ç”¨çš„æ˜¯Ubuntuçš„è™šæ‹Ÿæœºï¼Œå› æ­¤æ‰§è¡Œçš„æ˜¯linuxè¯­å¥
```

#### 4ã€Pip install requests

```python
# ä¸ºpyç¨‹åºçš„æ‰§è¡Œå®‰è£…ç¬¬ä¸‰æ–¹åº“requests
run: |
    pip3 install requests,Crypto
```

#### 5ã€HealthCheckin

```python
# è¿è¡Œpyè„šæœ¬æ–‡ä»¶
run: |
    python3 17wanxiao.py <<EOF
    ${{secrets.USERNAME}}
    ${{secrets.PASSWORD}}
    ${{secrets.ADDRESS}}
    ${{secrets.ADDTEXT}}
    ${{secrets.CODE}}
    ${{secrets.EMERGENCY}}
    ${{secrets.EMERGENCYPHONE}}
    ${{secrets.SCKEY}}
    EOF
```

### äº”ã€æ¸…ç©ºCommitè®°å½•

> å¯èƒ½ç”±äºå¤§å®¶æµ‹è¯•å¡«å†™è‡ªå·±çš„æ•°æ®è¿›å…¥pyæ–‡ä»¶ä¸­ï¼Œä¼šåœ¨commitè®°å½•ä¸­å‡ºç°
>
> ä¸ºäº†ä¿æŠ¤è‡ªå·±çš„ä¿¡æ¯ï¼Œåº”è¯¥æ¸…é™¤commitè®°å½•

1ã€åœ¨è‡ªå·±ç”µè„‘æ¡Œé¢æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹(é»˜è®¤ä½ å·²å®‰è£…git)

2ã€è¿›å…¥æ–‡ä»¶å¤¹ï¼Œå³é”®ç‚¹å‡» Git Bash Hereï¼Œä¾æ¬¡è¿è¡Œå¦‚ä¸‹å‘½ä»¤

```
git init
git clone git@github.com:.../17wanxiaoCheckin-Actions.git(ä½ é¡¹ç›®çš„sshåœ°å€)
```

3ã€è¿›å…¥å…‹éš†ä¹‹åçš„æ–‡ä»¶å¤¹ï¼Œå³é”®ç‚¹å‡» Git Bash Hereï¼Œä¾æ¬¡è¿è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯

```
git checkout --orphan newBranch
git add -A  # Add all files and commit them
git commit -am "change"
git branch -D master  # Deletes the master branch
git branch -m master  # Rename the current branch to master
git push -f origin master  # Force push master branch to github
git gc --aggressive --prune=all     # remove the old files
```

### å…­ã€èµèµ

å¦‚æœä½ è§‰å¾—è¯¥æ•™ç¨‹å†™å¾—è¿˜å¯ä»¥ä¸”æœ‰å¸®åˆ°ä½ çš„è¯ï¼Œæ¬¢è¿ç»™æˆ‘æ‰“èµä¸€æ¯å¥¶èŒ¶~~

<img src="https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/æ”¯ä»˜å®.jpg" width="300"/><img src="https://cdn.jsdelivr.net/gh/ReaJason/17wanxiaoCheckin-Actions/Pictures/å¾®ä¿¡.png" width="300"/>



